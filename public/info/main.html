<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./css/info_style.css">
  <script src="./index.js"></script>
  <title>개인 정보 탭</title>
</head>
<body>
  <div id="container">
    <a href="../login_regist/index.html"><!--로그인 시 아래쪽처럼 값이 들어감. -->
      <div id="userinfo">
        <!-- <img src="./source/avata.png" alt="avata">
        <div id="user">
          <h2>로그인이 필요합니다</h2>
          <p></p>
        </div> -->
        <!-- 로그인시 -->
      <img src="./source/image.jpg" alt="강아지" id="userimg">
      <div id="user">
        <h2>ID</h2>
        <p>name</p>s
      </div>
      </div>
  </a>
    <div id="alarm" class="section">
        <div><span class="font-ctrl">알림 수신</span></div>
        <div><label for="push_alram"><input type="checkbox" name="push_alram" id="push_alram" onclick="pushAlramSwitch()"></label></div>
    </div>
    <hr>
    <a href="./bookmark.html"><div id="bookmark" class="section"><span class="font-ctrl">북마크</span></div></a>
    <hr>
    <a href="./info.html"><div id="introduce" class="section"><span class="font-ctrl">클린잇 소개 /위생등급 기준</span></div></a>
    <hr>
    <a target="_blank" href="https://www.foodsafetykorea.go.kr/minwon/complain/complainIntro.do?menu_no=618&menu_grp=MENU_GRP24"><div id="complaint" class="section"><span class="font-ctrl">
      위생 불량 신고</span>
    </div></a>
    <hr>
  </div>
  <button id="notifyBtn">알림 쿠키 생성</button>
  <p style="position:relative; bottom:70px; color:#595959">부정·불량 식품 신고는 국번없이 1399(무료)</p>
  <footer><a href="../main/index.html"><img src="./source/zip.png" alt="홈버튼 이미지" id="tohome"></a></footer>
  <script src="./javascript/main.js"></script>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js"; 
    import { getMessaging, getToken} from "https://www.gstatic.com/firebasejs/10.11.0/firebase-messaging.js";

    const firebaseConfig = {
        apiKey: "AIzaSyDLwmwOZiprAUt16GYQNznmNBoOKJNCYG4",
        authDomain: "easylogin-b519a.firebaseapp.com",
        projectId: "easylogin-b519a",
        storageBucket: "easylogin-b519a.appspot.com",
        messagingSenderId: "270766993601",
        appId: "1:270766993601:web:aa3199d115b3b816412440",
        measurementId: "G-XM5967EN5W"
    };

    const app = initializeApp(firebaseConfig);
    const messaging = getMessaging(app);

    window.requestToken = () => {
  function requestPermission() {
    console.log('Requesting permission...');
    Notification.requestPermission().then((permission) => {
      if (permission === 'granted') {
        console.log('Notification permission granted.');
        // Get registration token
        getToken(messaging).then((currentToken) => {
          if (currentToken) {
            console.log('Received registration token:', currentToken);
          } else {
            console.log('No registration token available.');
          }
        }).catch((err) => {
          console.log('An error occurred while retrieving token:', err);
        });
      } else {
        console.log('Notification permission denied.');
      }
    });
  }

  // Call requestPermission function to request notification permission
  requestPermission();

};
  export function registerServiceWorker() {
  if ("serviceWorker" in navigator) {
      window.addEventListener("load", function () {
          navigator.serviceWorker
              .register("../firebase-messaging-sw.js")
              .then(function (registration) {
                  console.log(
                      "Service Worker가 scope에 등록되었습니다.:",
                      registration.scope
                  );
              })
              .catch(function (err) {
                  console.log("Service Worker 등록 실패:", err);
              });
      });
  }
}

    document.getElementById('notifyBtn').addEventListener('click', requestToken);
  </script>
</body>
</html>