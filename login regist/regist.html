<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Regist</title>
    <link rel="stylesheet" href="./regist_style.css">
    <style>
        /* 버튼 스타일 */
        .custom-button {
            padding: 10px 20px;
            background-color: white;
            color: white;
            border: 2px solid #8AE9FF;
            border-radius: 30px;
            position: relative;
            height: 25px;
            width: 64px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        /* 활성화된 버튼의 배경색 */
        .custom-button.active {
            background-color: #007bff;
        }
        
        /* 동그라미 아이콘 스타일 */
        .circle-icon {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background-color: #8AE9FF;
            display: inline-block;
            justify-content: center;
            align-items: center;
            color: #007bff;
            position: absolute;
            top: 50%;
            right: 40px;
            transform: translateY(-50%);
            transition: right 0.3s ease;
        }

        .custom-button.active .circle-icon {
            right: 5px;
        }

        .bottom{
            text-align: center;

        }
    </style>
</head>
<body>
    <div id="back-button"><a href="./index.html"><img src="../../css/images/backicon.png" alt="" style="width: 40px;"></a></div>
    <div class="container">
    <form class="Register-form">

        <div class="int-area">
            <input type="email" id="signUpEmail" placeholder="아이디" style="width: 70%; max-width: 210px; display: inline-block; color:#0ECFFF">
            <button type="button" style="display: inline-block; width: 80px; height: 29.9px;font-weight: bold;" onclick="checkID()">중복 확인</button>
            <p id="p6">아이디는 6자 이상의 영문자만 가능합니다.</p>

        </div>



        <script>
            function checkID() {
                var pElement = document.getElementById('p6');
                pElement.textContent = '가입이 가능한 아이디입니다.';
                pElement.style.color = '#0ECFFF';
            }
        </script>


        <div class="int-area">
            <input type="password" id="signUpPassword" placeholder="비밀번호" oninput="checkPassword(); checkPasswordMatch()" style="width:230px">
            
            <!-- 첫 번째 SVG 이미지 -->
            <svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512" id="svgButton" width="18px" height="18px" onclick="toggleToText()">
                <path d="M432 448a15.92 15.92 0 01-11.31-4.69l-352-352a16 16 0 0122.62-22.62l352 352A16 16 0 01432 448zM255.66 384c-41.49 0-81.5-12.28-118.92-36.5-34.07-22-64.74-53.51-88.7-91v-.08c19.94-28.57 41.78-52.73 65.24-72.21a2 2 0 00.14-2.94L93.5 161.38a2 2 0 00-2.71-.12c-24.92 21-48.05 46.76-69.08 76.92a31.92 31.92 0 00-.64 35.54c26.41 41.33 60.4 76.14 98.28 100.65C162 402 207.9 416 255.66 416a239.13 239.13 0 0075.8-12.58 2 2 0 00.77-3.31l-21.58-21.58a4 4 0 00-3.83-1 204.8 204.8 0 01-51.16 6.47zM490.84 238.6c-26.46-40.92-60.79-75.68-99.27-100.53C349 110.55 302 96 255.66 96a227.34 227.34 0 00-74.89 12.83 2 2 0 00-.75 3.31l21.55 21.55a4 4 0 003.88 1 192.82 192.82 0 0150.21-6.69c40.69 0 80.58 12.43 118.55 37 34.71 22.4 65.74 53.88 89.76 91a.13.13 0 010 .16 310.72 310.72 0 01-64.12 72.73 2 2 0 00-.15 2.95l19.9 19.89a2 2 0 002.7.13 343.49 343.49 0 0068.64-78.48 32.2 32.2 0 00-.1-34.78z"/><path d="M256 160a95.88 95.88 0 00-21.37 2.4 2 2 0 00-1 3.38l112.59 112.56a2 2 0 003.38-1A96 96 0 00256 160zM165.78 233.66a2 2 0 00-3.38 1 96 96 0 00115 115 2 2 0 001-3.38z"/>
            </svg>
            <!-- 두 번째 SVG 이미지 -->
            <svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512" id="svgButton2" width="18px" height="18px" onclick="toggleToPassword()">
                <path d="M255.66 112c-77.94 0-157.89 45.11-220.83 135.33a16 16 0 00-.27 17.77C82.92 340.8 161.8 400 255.66 400c92.84 0 173.34-59.38 221.79-135.25a16.14 16.14 0 000-17.47C428.89 172.28 347.8 112 255.66 112z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/><circle cx="256" cy="256" r="80" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/>
            </svg>
            
            <p id="p2">최소 11자 이상, 대문자 및 특수기호가 포함되어야 합니다.</p>
            
            <input type="password" id="signUpPasswordRe" placeholder="비밀번호 확인" oninput="checkPasswordMatch()" style="width:230px">

            <!-- 첫 번째 SVG 이미지 -->
            <svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512" id="svgButton3" width="18px" height="18px" onclick="toggleToText2()">
                <path d="M432 448a15.92 15.92 0 01-11.31-4.69l-352-352a16 16 0 0122.62-22.62l352 352A16 16 0 01432 448zM255.66 384c-41.49 0-81.5-12.28-118.92-36.5-34.07-22-64.74-53.51-88.7-91v-.08c19.94-28.57 41.78-52.73 65.24-72.21a2 2 0 00.14-2.94L93.5 161.38a2 2 0 00-2.71-.12c-24.92 21-48.05 46.76-69.08 76.92a31.92 31.92 0 00-.64 35.54c26.41 41.33 60.4 76.14 98.28 100.65C162 402 207.9 416 255.66 416a239.13 239.13 0 0075.8-12.58 2 2 0 00.77-3.31l-21.58-21.58a4 4 0 00-3.83-1 204.8 204.8 0 01-51.16 6.47zM490.84 238.6c-26.46-40.92-60.79-75.68-99.27-100.53C349 110.55 302 96 255.66 96a227.34 227.34 0 00-74.89 12.83 2 2 0 00-.75 3.31l21.55 21.55a4 4 0 003.88 1 192.82 192.82 0 0150.21-6.69c40.69 0 80.58 12.43 118.55 37 34.71 22.4 65.74 53.88 89.76 91a.13.13 0 010 .16 310.72 310.72 0 01-64.12 72.73 2 2 0 00-.15 2.95l19.9 19.89a2 2 0 002.7.13 343.49 343.49 0 0068.64-78.48 32.2 32.2 0 00-.1-34.78z"/><path d="M256 160a95.88 95.88 0 00-21.37 2.4 2 2 0 00-1 3.38l112.59 112.56a2 2 0 003.38-1A96 96 0 00256 160zM165.78 233.66a2 2 0 00-3.38 1 96 96 0 00115 115 2 2 0 001-3.38z"/>
            </svg>
            <!-- 두 번째 SVG 이미지 -->
            <svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512" id="svgButton4" width="18px" height="18px" onclick="toggleToPassword2()">
                <path d="M255.66 112c-77.94 0-157.89 45.11-220.83 135.33a16 16 0 00-.27 17.77C82.92 340.8 161.8 400 255.66 400c92.84 0 173.34-59.38 221.79-135.25a16.14 16.14 0 000-17.47C428.89 172.28 347.8 112 255.66 112z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/><circle cx="256" cy="256" r="80" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/>
            </svg>
            <p id="p3" style="color:white">--</p>

        </div>
        
        

        <script>
            /* eye-off를 클릭하면 비밀번호 안의 내용이 텍스트형으로 변환*/
            function toggleToText() {
                var passwordInput = document.getElementById("signUpPassword");
                var svgButton = document.getElementById("svgButton");
                var svgButton2 = document.getElementById("svgButton2");
        
                passwordInput.type = "text";
                svgButton.style.display = "none";
                svgButton2.style.display = "inline";
                svgButton2.setAttribute("style", "color: black");
            }
            /* eye를 클릭하면 비밀번호 안의 내용이 비밀번호형을 변환*/
            function toggleToPassword() {
                var passwordInput = document.getElementById("signUpPassword");
                var svgButton = document.getElementById("svgButton");
                var svgButton2 = document.getElementById("svgButton2");
        
                passwordInput.type = "password";
                svgButton.style.display = "inline";
                svgButton2.style.display = "none";
            }
        </script>
        <script>
            /* 비밀번호 확인 안의 내용 텍스트형으로 변환*/
            function toggleToText2() {
                var passwordInput = document.getElementById("signUpPasswordRe");
                var svgButton = document.getElementById("svgButton3");
                var svgButton2 = document.getElementById("svgButton4");
        
                passwordInput.type = "text";
                svgButton.style.display = "none";
                svgButton2.style.display = "inline";
                svgButton2.setAttribute("style", "color: black");
            }
            /*비밀번호 확인 안의 내용 비밀번호형으로 변환*/
            function toggleToPassword2() {
                var passwordInput = document.getElementById("signUpPasswordRe");
                var svgButton = document.getElementById("svgButton3");
                var svgButton2 = document.getElementById("svgButton4");
        
                passwordInput.type = "password";
                svgButton.style.display = "inline";
                svgButton2.style.display = "none";
            }
        </script>
        

        <script>
            /*비밀번호의 유효성 검사
            11자 이상, 대문자와 특수문자를 반드시 포함해야함*/
            function checkPassword() {
                var password = document.getElementById('signUpPassword').value;
                var isValid = password.length >= 11 && /[A-Z]/.test(password) && /[\W_]/.test(password);
                var pElement = document.querySelector('.int-area>#p2');
                if (isValid) {
                    pElement.textContent = '비밀번호가 유효합니다.';
                    pElement.style.color = '#0ECFFF';
                } else {
                    pElement.textContent = '사용 불가능한 비밀번호입니다.';
                    pElement.style.color = '#FF0000';
                }
            }
        </script>
        <script>
            var passwordMatchMessage = null;
            /* 비밀번호와 비밀번호 확인의 내용이 같은지 확인*/      
            function checkPasswordMatch() {
                var password = document.getElementById('signUpPassword').value;
                var confirmPassword = document.getElementById('signUpPasswordRe').value;
        
                var passwordsMatch = password === confirmPassword;
        
                var pElement2 = document.querySelector('.int-area>#p3');
                
                if (passwordsMatch) {
                    pElement2.textContent = '비밀번호가 확인되었습니다.';
                    pElement2.style.color = '#0ECFFF';
                } else {
                    pElement2.textContent = '비밀번호가 일치하지 않습니다.';
                    pElement2.style.color = '#FF0000';
                }
            }
        </script>

        <div class="individual">
            <input type="text" placeholder="이름" style="width: 210px;">
        </div>
        <div class="individual" id="EmailEX">
            <input type="email" id="signUpEmail" placeholder="전화번호" style="width: 70%; max-width: 210px; display: inline-block;">
            <button type="button" style="display: inline-block; width: 80px; height:29.9px; font-weight: bold;" onclick="addInput() ">인증 요청</button>
        </div>
        <div id="additionalInputs"></div>
        <div class="individual">
            <input id="validEmail" type="text" placeholder="이메일" style="max-width: 210px;" oninput="checkEmail()">
            <p id="pId" style="color:white; font-family: 'NanumBarunGothicUltraLight'; margin-left:8px; margin-top: 6px;">--</p>
        </div>
        
</form>
<script>
     var timerInterval; // 변수를 미리 정의합니다.

function resetInputs() {
    // Clear previous timer interval if it exists
    if (timerInterval) {
        clearInterval(timerInterval);
    }

    // Remove the container div containing the input and timer
    var containerDiv = document.querySelector('#EmailEX + div');
    if (containerDiv) {
        containerDiv.parentElement.removeChild(containerDiv);
    }
}

function addInput() {
    // Reset previous inputs
    resetInputs();

    // Create a container div
    var containerDiv = document.createElement('div');
    containerDiv.style.display = 'flex';
    containerDiv.style.alignItems = 'center';

    // Create new email input field
    var newInput = document.createElement('input');
    newInput.type = 'email';
    newInput.placeholder = '인증번호 입력';
    newInput.style.width = '70%';
    newInput.style.padding = '40px 5px 10px';
    newInput.style.backgroundColor = 'transparent';
    newInput.style.border = 'none';
    newInput.style.borderBottom = '1px solid #B4B4B4';
    newInput.style.fontSize = '16px';
    newInput.style.color = '#0ECFFF';
    newInput.style.outline = 'none';
    newInput.style.maxWidth = '210px';

    // Create timer element
    var timerElement = document.createElement('span');
    timerElement.textContent = '5:00';
    timerElement.style.marginLeft = '10px';
    timerElement.style.color = '#B4B4B4';
    timerElement.style.fontSize = '14px';
    timerElement.style.marginTop = '30px';



    // Append input field and timer to container div
    containerDiv.appendChild(newInput);
    containerDiv.appendChild(timerElement);

    // Insert the container div after the element with the id 'EmailEX'
    var signUpEmailDiv = document.getElementById('EmailEX');
    signUpEmailDiv.insertAdjacentElement('afterend', containerDiv);

    // Start the timer countdown
    var timer = 5 * 60; // 5 minutes in seconds
    timerInterval = setInterval(function() {
    var minutes = Math.floor(timer / 60);
    var seconds = timer % 60;

    // Display the timer value in format MM:SS
    timerElement.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

    // Decrease timer by 1 second
    timer--;

    // If timer reaches 0, clear the interval
    if (timer < 0) {
        clearInterval(timerInterval);
    // You can add additional actions when the timer reaches 0 here
    }
    }, 1000); // Update timer every second
}

function checkEmail() {
var emailInput = document.getElementById('validEmail').value;
var isValid = /^[a-zA-Z0-9+-\_.]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/.test(emailInput) && emailInput.includes('@') && emailInput.includes('.');

if (!isValid) {
    var errorMessage = document.getElementById('pId');
        errorMessage.textContent = '이메일 주소 형식이 올바르지 않습니다.';
        errorMessage.style.color = 'red';
        errorMessage.style.fontSize = '10px';
        errorMessage.style.fontWeight = 'light';
}else{
    var errorMessage = document.getElementById('pId');
    errorMessage.style.color = 'white';
}
}
</script>
<div id="additionalInputs"></div>



<div class="bottom">
    <div class="alarm">
        <p style="text-align: center; margin-top: 80px; font-size: 14px;">클린잇의 소식을 알림으로 받기</p>
        <button style="margin-left: 10px;"><i class="fas fa-circle"></i></button>
    </div>
    
    <div class="circleBtn">
        <button class="custom-button" onclick="toggleBackground()">
            <div class="circle-icon">
                <i class="fas fa-circle"></i>
            </div>
        </button>
    </div>
    </div>
</div>

    <form class="Login-form">
        <h1>LOGIN</h1>
        <div><input type="email" id="signInEmail"></div>
        <div><input type="password" id="signInPassword"></div>
        <button type="submit" id="signInButton">로그인</button>
        <button>회원가입</button>
    </form>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-analytics.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
    
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyDLwmwOZiprAUt16GYQNznmNBoOKJNCYG4",
            authDomain: "easylogin-b519a.firebaseapp.com",
            projectId: "easylogin-b519a",
            storageBucket: "easylogin-b519a.appspot.com",
            messagingSenderId: "270766993601",
            appId: "1:270766993601:web:aa3199d115b3b816412440",
            measurementId: "G-XM5967EN5W"
        };
    
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);

        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-auth.js";

        const auth = getAuth();

        document.getElementById('signUpButton').addEventListener('click', (event) => {
            event.preventDefault()
            const signUpEmail = document.getElementById('signUpEmail').value
            const signUpPassword = document.getElementById('signUpPassword').value

            createUserWithEmailAndPassword(auth, signUpEmail, signUpPassword)
                .then((userCredential) => {
                    console.log(userCredential)
                    // Signed in 
                    const user = userCredential.user;
                    // ...
                })
                .catch((error) => {
                    console.log('회원가입 실패');
                    let errorMessage;

                    if (error.code === 'auth/email-already-in-use') {
                        errorMessage = '이미 사용 중인 이메일 주소입니다.';
                    } else {
                        errorMessage = '회원가입 중 오류가 발생했습니다. 다시 시도해주세요.';
                    }

                    const popup = document.createElement('div');
                    popup.classList.add('popup');
                    popup.innerHTML = `
                        <div class="popup-content">
                            <p>${errorMessage}</p>
                            <button class="close-popup">닫기</button>
                        </div>
                    `;
                    document.body.appendChild(popup);

                    const closePopupBtn = popup.querySelector('.close-popup');
                    closePopupBtn.addEventListener('click', () => {
                        popup.remove();
                    });
                });
                    });
            document.getElementById('signInButton').addEventListener('click', (event) => {
                event.preventDefault()
                const signInEmail = document.getElementById('signInEmail').value
                const signInPassword = document.getElementById('signInPassword').value
                signInWithEmailAndPassword(auth, signInEmail, signInPassword)
                    .then((userCredential) => {
                        // Signed in 
                        console.log(userCredential)
                        const user = userCredential.user;
                        // ...
                    })
                    .catch((error) => {
                        console.error('Firebase Error:', error);
                        const errorCode = error.code;
                        let errorMessage;
                        if (errorCode === 'auth/email-already-in-use') {
                            errorMessage = '이미 사용 중인 이메일입니다.';
                        } else {
                            errorMessage = '오류가 발생했습니다. 다시 시도해주세요.';
                        }
                        document.getElementById('errorPopup').style.display = 'block';
                        document.getElementById('errorMessage').innerText = errorMessage;
                    });
                    });
            
                    

        </script>
        
        <script>
            var isBackgroundChanged = false;
        
            function toggleBackground() {
                var button = document.querySelector('.custom-button');
                var circleIcon = document.querySelector('.circle-icon');
        
                if (!isBackgroundChanged) {
                    button.style.backgroundColor = '#2FD8FF'; // Change to the new color
                    circleIcon.style.right = '5px'; // Move circle-icon to the right
                } else {
                    button.style.backgroundColor = '#FFFFFF'; // Revert to the original color
                    circleIcon.style.right = '40px'; // Move circle-icon back to its original position
                }
        
                isBackgroundChanged = !isBackgroundChanged;
            }
        </script>
    
</body>
</html>